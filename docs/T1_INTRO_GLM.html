<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.542">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CSEE Inferencia 2, temas 1 a 8 de modelización - Tema 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CSEE Inferencia 2, temas 1 a 8 de modelización</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./T1_INTRO_GLM.html" aria-current="page"> 
<span class="menu-text">Tema 1</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://twitter.com/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/luija85/GLM_CEE" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tema-1-introducción-a-glm" id="toc-tema-1-introducción-a-glm" class="nav-link active" data-scroll-target="#tema-1-introducción-a-glm">TEMA 1: INTRODUCCIÓN A GLM</a>
  <ul class="collapse">
  <li><a href="#introducción" id="toc-introducción" class="nav-link" data-scroll-target="#introducción">INTRODUCCIÓN</a>
  <ul class="collapse">
  <li><a href="#componente-aleatoria-familia-de-dispersión-exponencial" id="toc-componente-aleatoria-familia-de-dispersión-exponencial" class="nav-link" data-scroll-target="#componente-aleatoria-familia-de-dispersión-exponencial">COMPONENTE ALEATORIA: FAMILIA DE DISPERSIÓN EXPONENCIAL</a></li>
  <li><a href="#función-de-enlace-canónica-y-predictor-lineal" id="toc-función-de-enlace-canónica-y-predictor-lineal" class="nav-link" data-scroll-target="#función-de-enlace-canónica-y-predictor-lineal">FUNCIÓN DE ENLACE CANÓNICA Y PREDICTOR LINEAL</a></li>
  </ul></li>
  <li><a href="#ecuaciones-de-verosimilitud" id="toc-ecuaciones-de-verosimilitud" class="nav-link" data-scroll-target="#ecuaciones-de-verosimilitud">ECUACIONES DE VEROSIMILITUD</a></li>
  <li><a href="#inferencia-en-el-glm" id="toc-inferencia-en-el-glm" class="nav-link" data-scroll-target="#inferencia-en-el-glm">INFERENCIA EN EL GLM</a>
  <ul class="collapse">
  <li><a href="#test-de-razón-de-verosimilitudes" id="toc-test-de-razón-de-verosimilitudes" class="nav-link" data-scroll-target="#test-de-razón-de-verosimilitudes">TEST DE RAZÓN DE VEROSIMILITUDES</a></li>
  <li><a href="#tests-de-wald" id="toc-tests-de-wald" class="nav-link" data-scroll-target="#tests-de-wald">TESTS DE WALD</a></li>
  <li><a href="#test-score" id="toc-test-score" class="nav-link" data-scroll-target="#test-score">TEST SCORE</a></li>
  <li><a href="#intervalos-de-confianza-a-partir-de-la-inversión-de-tests" id="toc-intervalos-de-confianza-a-partir-de-la-inversión-de-tests" class="nav-link" data-scroll-target="#intervalos-de-confianza-a-partir-de-la-inversión-de-tests">INTERVALOS DE CONFIANZA A PARTIR DE LA INVERSIÓN DE TESTS</a></li>
  </ul></li>
  <li><a href="#deviance-de-un-glm-comparación-y-validación" id="toc-deviance-de-un-glm-comparación-y-validación" class="nav-link" data-scroll-target="#deviance-de-un-glm-comparación-y-validación">DEVIANCE DE UN GLM, COMPARACIÓN Y VALIDACIÓN</a></li>
  <li><a href="#selección-de-variables-explicativas" id="toc-selección-de-variables-explicativas" class="nav-link" data-scroll-target="#selección-de-variables-explicativas">SELECCIÓN DE VARIABLES EXPLICATIVAS</a></li>
  <li><a href="#ejemplo-completo" id="toc-ejemplo-completo" class="nav-link" data-scroll-target="#ejemplo-completo">EJEMPLO COMPLETO</a></li>
  <li><a href="#ejercicios" id="toc-ejercicios" class="nav-link" data-scroll-target="#ejercicios">EJERCICIOS</a>
  <ul class="collapse">
  <li><a href="#ejercicio-1" id="toc-ejercicio-1" class="nav-link" data-scroll-target="#ejercicio-1">EJERCICIO 1</a></li>
  <li><a href="#ejercicio-2" id="toc-ejercicio-2" class="nav-link" data-scroll-target="#ejercicio-2">EJERCICIO 2</a></li>
  <li><a href="#ejercicio-3-agresti-4.6" id="toc-ejercicio-3-agresti-4.6" class="nav-link" data-scroll-target="#ejercicio-3-agresti-4.6">EJERCICIO 3 (AGRESTI 4.6)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tema 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="tema-1-introducción-a-glm" class="level1">
<h1>TEMA 1: INTRODUCCIÓN A GLM</h1>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">INTRODUCCIÓN</h2>
<p><strong>¿Cuál es la probabilidad de aceptar cierta oferta, en función de las características del producto, y del tipo de potenciales clientes que pueden acceder a ella?</strong></p>
<p><strong>¿Qué cantidad de personas se moverá a lo largo del periodo estival?</strong></p>
<p><strong>¿Cómo influyen las distintas dosis de un nuevo medicamento en la mejora de los síntomas en pacientes con una condición específica, considerando no solo las características individuales de los pacientes, sino también las variaciones entre diferentes centros de tratamiento?</strong></p>
<p>Estas preguntas podrían asociarse a un problema de regresión, aunque podemos ver variaciones que puede que no encajen con un modelo de regresión lineal tradicional. En las cuestionesanteriores encontraríamos los siguientes motivos para justivicar esto:</p>
<p><em>1. La variable respuesta no es normal.</em></p>
<p><em>2. El rango la variable respuesta no son todos los números reales, como ocurre en el segundo ejemplo, donde el rango son los números enteros no negativos.</em></p>
<p><em>3. Si tenemos en cuenta una estructura jerárquica de la población, un modelo lineal no recoge los efectos de dicha estructura. Esto ocurre en el tercer ejemplo: un paciente se asocia a un centro de tratamiento, pudiendo entender este como un nivel superior.</em></p>
<p>Respuesta binaria, de recuento, categórica, o acotada nos indica que puede que un modelo de regresión lineal no sea adecuado. En tal caso se propone el uso de una generalización de la especificación lineal. Estos son los modelos lineales generales, y esto se consigue a través de una función de enlace, o siendo más concretos las componentes de estos modelos son:</p>
<p><strong><em>1. Componente aleatoria.</em></strong></p>
<p><strong><em>2. Predictor lineal.</em></strong></p>
<p><strong><em>3. Función de enlace.</em></strong></p>
<p>En este capítulo veremos cada uno de estos componentes, el ajuste de parámetros, inferencia sobre los mismos, el estudio del error, y la selección del modelo.</p>
<section id="componente-aleatoria-familia-de-dispersión-exponencial" class="level3">
<h3 class="anchored" data-anchor-id="componente-aleatoria-familia-de-dispersión-exponencial">COMPONENTE ALEATORIA: FAMILIA DE DISPERSIÓN EXPONENCIAL</h3>
<p>La componente aleatoria de los modelos que vamos a considerar se ajustan a lo que se conoce como la familia de diespersión exponencial:</p>
<p><span class="math display">\[f\left(y_i ; \theta_i, \phi\right)=\exp \left\{\frac{y_i \theta_i-b\left(\theta_i\right)}{a(\phi)}+c\left(y_i, \phi\right)\right\}\]</span> A <span class="math inline">\(\theta_i\)</span> se le llama <strong>parámetro natural</strong>, y a <span class="math inline">\(\phi\)</span> <strong>parámetro de dispersión</strong>.</p>
<p>La función de verosimilitud, dada una muestra, viene dado por el producto de las funciones de densidad para cada una de las observaciones (en este caso fijas, y no variables) y viendo los parámetros como las variables a ajustar. Por comodidad se toma la <strong>función de log-verosimilitud:</strong></p>
<p><span class="math display">\[L_i = \log(f(y_i,\theta_i,\phi)) = \frac{y_i \theta_i-b\left(\theta_i\right)}{a(\phi)}+c\left(y_i, \phi\right)\ \ \ \ \Longrightarrow\ \ \ \ \ \ L = \sum_iL_i\]</span></p>
<p>Teniendo en cuenta las condiciones de regularidad para la familia exponencial, al tomar esperanza sobre las derivadas de primer y segundo orden de la función de log-verosimilitud, se llega a que:</p>
<p><span class="math display">\[\begin{array}{lcl}
\mu_i = E[y_i] &amp; = &amp; b'(\theta_i)\\
Var(y_i) &amp; = &amp; b''(\theta_i)a(\phi)
\end{array}\]</span></p>
</section>
<section id="función-de-enlace-canónica-y-predictor-lineal" class="level3">
<h3 class="anchored" data-anchor-id="función-de-enlace-canónica-y-predictor-lineal">FUNCIÓN DE ENLACE CANÓNICA Y PREDICTOR LINEAL</h3>
<p>Las variables predictoras se relacionan con la variable respuesta a través de la función de enlace. En el caso del <em>enlace canónico</em> tenemos <span class="math display">\[\eta_i=\sum_{j=1}^p\beta_jx_{ij}=g(\mu_i)\]</span> <strong>¿Cómo podemos expresar en función de</strong> <span class="math inline">\(b(·)\)</span>?</p>
</section>
</section>
<section id="ecuaciones-de-verosimilitud" class="level2">
<h2 class="anchored" data-anchor-id="ecuaciones-de-verosimilitud">ECUACIONES DE VEROSIMILITUD</h2>
<p>Teniendo en cuenta las relaciones entre <span class="math inline">\(\eta_i=g(\mu_i)=\sum_j\beta_jx_{ij}\)</span> si calculamos derivadas parciales respecto <span class="math inline">\(\mathrm{\beta}\)</span> de la función de log-verosimilitud, e igualamos a cero, el sistema de ecuaciones obtenido son las <strong>ECUACIONES DE VEROSIMILITUD</strong>, que vienen dadas por:</p>
<p><span class="math display">\[
\frac{\partial L(\mathrm{\beta})}{\partial \beta_j}=\sum_{i=1}^n\frac{(y_i-\mu_i)x_{ij}}{var(y_i)}\frac{\partial\mu_i}{\partial \eta_i}=0\ \ \ \ ,\ \ \ \ j=1,\ldots,p.
\]</span></p>
<p>siendo <span class="math inline">\(p\)</span> el número de variables predictoras. Se trata de un sistema de ecuaciones, que en general son no lineales, con incógnitas <span class="math inline">\(\beta_j\)</span>: <strong>¿dónde están las incógnitas en el sistema de ecuaciones?</strong></p>
<p>En términos matriciales podríamos escribir como: <span class="math display">\[\mathrm{X^TDV^{-1}}(\mathrm{y-\mu})=\mathrm{0}\]</span></p>
<p>donde <span class="math inline">\(D=\text{diag}\{\frac{\partial\mu_i}{\partial\eta_i}\}\)</span>, y <span class="math inline">\(V\)</span> matriz diagonal con las inversas de las varianzas de <span class="math inline">\(y_i\)</span>.</p>
</section>
<section id="inferencia-en-el-glm" class="level2">
<h2 class="anchored" data-anchor-id="inferencia-en-el-glm">INFERENCIA EN EL GLM</h2>
<p>El tipo de tests en los que nos centramos son:</p>
<p><span class="math display">\[
H_0:\mathrm{\Lambda\beta} =\mathrm{0}
\]</span></p>
<p>combinación lineal de parámetros del modelo. En particular, nos centramos en:</p>
<ol type="1">
<li><strong>Significación individual:</strong> caso en que <span class="math inline">\(\Lambda = (0,\ldots,0,1,0,\ldots,0)\)</span> todos los valores nulos, salvo la posición <span class="math inline">\(j\)</span>, dando lugar a :<span class="math display">\[
H_0:\beta_j = 0\]</span></li>
<li><strong>Significación global</strong>: cuando <span class="math inline">\(\Lambda\)</span> es la matriz identidad de orden <span class="math inline">\(p\)</span>. En tal caso se quiere contrastar si <span class="math inline">\(\mathrm{\beta}\)</span> es conjuntamente significativo.</li>
</ol>
<p>Para estos casos, las alternativas que se presentan son 3:</p>
<ol type="1">
<li><strong>Test de razón de verosimilitudes</strong></li>
<li><strong>Tests de Wald</strong></li>
<li><strong>Tests score</strong></li>
</ol>
<p>Veamos cada uno de estos 3:</p>
<section id="test-de-razón-de-verosimilitudes" class="level3">
<h3 class="anchored" data-anchor-id="test-de-razón-de-verosimilitudes">TEST DE RAZÓN DE VEROSIMILITUDES</h3>
<p>El procedimiento de este test es estimar el cociente entre log-verosimilitudes correspondientes a la hipótesis nula en el numerador, y la alternativa en el denominador. El estadístico usado es:</p>
<p><span class="math display">\[
-2\log\Lambda = -2\log\left(\frac{\text{argmax}_{H_0}\text{verosim.}}{\text{argmax}_{H_1}\text{verosim.}}\right)=-2(L_0-L_1)
\]</span></p>
<p>donde <span class="math inline">\(L_0\)</span> es el valor máximo de la log-verosimilitud para la muestra bajo <span class="math inline">\(H_0\)</span>, y <span class="math inline">\(L_1\)</span> es el valor máximo de la log-verosimilitud para la muestra bajo <span class="math inline">\(H_1\)</span>. La distribución asintótica de este estadístico bajo <span class="math inline">\(H_0\)</span> es una <span class="math inline">\(\chi^2_1\)</span>, chi cuadrado con un grado de libertad (aproximación de Wilks).</p>
</section>
<section id="tests-de-wald" class="level3">
<h3 class="anchored" data-anchor-id="tests-de-wald">TESTS DE WALD</h3>
<p>Se basa en los errores estándar obtenidos de la inversa de la matriz de información, que depende de valores de los parámetros (teóricamente desconocidos):</p>
<p><span class="math display">\[
\frac{\beta-\beta_0}{SE}
\]</span></p>
<p>cuando la hipótesis planteada es, en caso de parámetros individuales:</p>
<p><span class="math display">\[
H_0: \beta=\beta_0
\]</span></p>
<p>La aproximación usada es considerar el estadístico anterior sustituyendo el valor desconocido por su estimación máximo verosímil, y en tal caso tendremos un estadístico con distribución conocida independiente de los parámetros:</p>
<p><span class="math display">\[
z =\frac{\hat{\beta}-\beta_0}{SE} \sim \mathcal{N}(0,1)\ \ \ \text{bajo }\ H_0
\]</span></p>
<p>de donde <span class="math inline">\(z^2\)</span> tiene una aproximación asintótica <span class="math inline">\(\chi^2_1\)</span>.</p>
<p>Para <em>múlitples parámetros</em>, si <span class="math inline">\(\beta = (\beta_0,\beta_1)\)</span> y querremos contrastar que el conjunto de parámetros <span class="math inline">\(\beta_0\)</span> es nulo, es decir</p>
<p><span class="math display">\[H_0 : \beta_0 = 0\]</span> el estadístico de Wald adopta la forma:</p>
<p><span class="math display">\[
\hat{\beta_0}^T\left[\widehat{var}(\hat{\beta}_0)\right]^{-1}\hat{\beta}_0
\]</span></p>
<p>que también sigue una <span class="math inline">\(\chi^2\)</span> con tantos grados de libertada como el número de parámetros a contrastar.</p>
</section>
<section id="test-score" class="level3">
<h3 class="anchored" data-anchor-id="test-score">TEST SCORE</h3>
<p>Este tests se basa en la pendiente esperada de la curvatura de la función de log-verosimilitud, evaluada en el valor correspondiente a <span class="math inline">\(H_0\)</span>. En el caso de parámetros individuales tenemos el siguiente estadístico que sigue una <span class="math inline">\(\chi^2\)</span></p>
<p><span class="math display">\[
\frac{\left[\frac{\partial L(\beta)}{\partial\beta_0}\right]^2}{-E\left[\frac{\partial L(\beta)}{\partial\beta_0}\right]^2},
\]</span></p>
<p>en el caso de multiparámetros tendremos un estadístico que adopta una forma cuadrática basada en el vector de derivadas parciales de la función de verosimilitud, y la inversa de la matriz de información. Será de la forma:</p>
<p><span class="math display">\[
\mathrm{L·I^{-1}·L}
\]</span></p>
<p>cuando <span class="math inline">\(L\)</span> sea el vector de derivadas parciales, e <span class="math inline">\(I\)</span> la matriz de información.</p>
<section id="ejercicio-deduce-los-estadísticos-anteriores-en-el-caso-de-un-modelo-binomial-con-proporción-muestral-hatpiy" class="level4">
<h4 class="anchored" data-anchor-id="ejercicio-deduce-los-estadísticos-anteriores-en-el-caso-de-un-modelo-binomial-con-proporción-muestral-hatpiy">EJERCICIO: Deduce los estadísticos anteriores en el caso de un modelo binomial, con proporción muestral <span class="math inline">\(\hat{\pi}=y\)</span></h4>
</section>
</section>
<section id="intervalos-de-confianza-a-partir-de-la-inversión-de-tests" class="level3">
<h3 class="anchored" data-anchor-id="intervalos-de-confianza-a-partir-de-la-inversión-de-tests">INTERVALOS DE CONFIANZA A PARTIR DE LA INVERSIÓN DE TESTS</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = count ~ race, family = poisson(link = "log"), data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.0218  -0.4295  -0.4295  -0.4295   6.1874  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -2.38321    0.09713  -24.54   &lt;2e-16 ***
race1        1.73314    0.14657   11.82   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 962.80  on 1307  degrees of freedom
Residual deviance: 844.71  on 1306  degrees of freedom
AIC: 1122

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1121.99</code></pre>
</div>
</div>
</section>
</section>
<section id="deviance-de-un-glm-comparación-y-validación" class="level2">
<h2 class="anchored" data-anchor-id="deviance-de-un-glm-comparación-y-validación">DEVIANCE DE UN GLM, COMPARACIÓN Y VALIDACIÓN</h2>
<p>En el contexto de los Modelos Lineales Generalizados (GLM), un modelo saturado se refiere a un modelo que incluye todos los términos posibles en la matriz de diseño. En otras palabras, el modelo saturado tiene un grado de libertad igual al número total de observaciones, lo que significa que tiene un parámetro para cada dato individual. Este tipo de modelo se ajusta perfectamente a los datos observados, y, por lo tanto, tiene cero residuos.</p>
<p>En un modelo saturado, la probabilidad ajustada para cada observación es exactamente igual al valor observado. Esto puede ser expresado matemáticamente como (y_i = _i), donde (y_i) es el valor observado y (_i) es el valor predicho por el modelo saturado para la i-ésima observación.</p>
<p><strong>Usos para la Validación de Modelos:</strong></p>
<ol type="1">
<li><strong>Prueba de Adecuación del Modelo:</strong>
<ul>
<li>Al comparar un modelo más simple con un modelo saturado, puedes realizar pruebas de hipótesis para evaluar la adecuación del modelo más simple en comparación con el modelo saturado. Esto se hace utilizando estadísticas de prueba como el estadístico de razón de verosimilitud (LRT) o el estadístico de Wald.</li>
</ul></li>
<li><strong>Comparación de Modelos:</strong>
<ul>
<li>Puedes utilizar el modelo saturado como punto de referencia para comparar la capacidad predictiva de modelos más simples. Si un modelo más simple proporciona ajuste similar al modelo saturado, es probable que sea más parsimonioso y, por lo tanto, preferible.</li>
</ul></li>
<li><strong>Identificación de Problemas:</strong>
<ul>
<li>La discrepancia entre un modelo saturado y un modelo más simple puede resaltar áreas donde el modelo más simple no se ajusta adecuadamente a los datos. Esto podría indicar problemas con la especificación del modelo o datos atípicos.</li>
</ul></li>
<li><strong>Análisis Residual:</strong>
<ul>
<li>Al comparar los residuos de un modelo más simple con los residuos del modelo saturado, puedes evaluar la presencia de patrones sistemáticos en los residuos que podrían indicar problemas en la especificación del modelo.</li>
</ul></li>
</ol>
<p>El modelo saturado sirve como un punto de referencia útil para evaluar la bondad de ajuste y la validez de modelos más simples en el contexto de los Modelos Lineales Generalizados, y esta línea es la que se va a seguir.</p>
<p>Usaremos la notación:</p>
<p><span class="math display">\[
\begin{array}{lcl}
\text{Log-verosimilitud del modelo a evaluar} &amp; : &amp; L(\hat{\mu},\mathrm{y})\\
\text{Log-verosimilitud del modelo saturado} &amp; : &amp; L(\mathrm{y},\mathrm{y})\\
\end{array}
\]</span></p>
<p>El estadístico usado es:</p>
<p><span class="math display">\[
-2\log\left[\frac{\text{max. verosimilitud del modelo a evaluar}}{\text{max. verosimilitud del modelo saturado}}\right])= -2[L(\hat{\mu};\mathrm{y})-L(\mathrm{y},\mathrm{y})]
\]</span></p>
<p>Si <span class="math inline">\(\tilde{\theta}_i\)</span> denota el parámetro natural para el modelo saturado, y <span class="math inline">\(\hat{\theta}_i\)</span> el parámetro natural para el modelo a evaluar, en el caso en que <span class="math inline">\(a(\phi) = \phi/\omega_i\)</span>, el estadístico adpota la expresión</p>
<p><span class="math display">\[
2\sum_i\omega_i\left[y_i(\tilde{\theta}_i-\hat{\theta}_i) - b(\tilde{\theta}_i)+b(\hat{\theta}_i)\right]/\phi=D(\mathrm{y};\hat{\mu})/\phi
\]</span></p>
<p>siendo <span class="math inline">\(D(\mathrm{y};\hat{\mu})\)</span> la <strong>deviance.</strong></p>
<p>Como <span class="math inline">\(L(\hat{\mu};\mathrm{y}) \leq L(\mathrm{y},\mathrm{y})\)</span> entonces <span class="math inline">\(D(y;\hat{\mu})\geq 0\)</span> y <strong>cuanta mayor sea la deviance, más pobre será nuestro modelo</strong>. El estadístico que se usará será</p>
<p><span class="math display">\[
D(\mathrm{y};\hat{\mu})/\phi
\]</span></p>
<p>que sigue una distribución asintótica <span class="math inline">\(\chi^2_k\)</span> donde <span class="math inline">\(k\)</span> es <em>la diferencia entre el número de parámetros del modelo saturado, y el número de parámetros del modelo a evaluar</em>.</p>
<p>En los casos en que <span class="math inline">\(\phi\)</span> sea conocido, se usa este estadístico para la validación del modelo. Su principal uso es para comparación de modelos, como veremos en próximas secciones.</p>
<section id="ejercicio-calcula-la-deviance-para-el-modelo-de-poisson-y-para-el-model-normal." class="level4">
<h4 class="anchored" data-anchor-id="ejercicio-calcula-la-deviance-para-el-modelo-de-poisson-y-para-el-model-normal.">EJERCICIO: Calcula la deviance para el modelo de Poisson y para el model normal.</h4>
</section>
</section>
<section id="selección-de-variables-explicativas" class="level2">
<h2 class="anchored" data-anchor-id="selección-de-variables-explicativas">SELECCIÓN DE VARIABLES EXPLICATIVAS</h2>
</section>
<section id="ejemplo-completo" class="level2">
<h2 class="anchored" data-anchor-id="ejemplo-completo">EJEMPLO COMPLETO</h2>
</section>
<section id="ejercicios" class="level2">
<h2 class="anchored" data-anchor-id="ejercicios">EJERCICIOS</h2>
<section id="ejercicio-1" class="level3">
<h3 class="anchored" data-anchor-id="ejercicio-1">EJERCICIO 1</h3>
<p>Dadas las siguientes distribuciones, probar que pertenecen a la familia exponencial, y calcular su media y varianza a partir de las funciones <span class="math inline">\(b(·)\)</span> y <span class="math inline">\(a(·)\)</span> obtenidas:</p>
<ol type="1">
<li>Distribución exponencial.</li>
<li>Distribución geométrica.</li>
<li>Distribución binomial negativa.</li>
</ol>
</section>
<section id="ejercicio-2" class="level3">
<h3 class="anchored" data-anchor-id="ejercicio-2">EJERCICIO 2</h3>
<p>Dada la distribución de Poisson:</p>
<ol type="1">
<li>Probar que pertenece a la familia exponencial, identificando las componentes de la misma.</li>
<li>Deducir media y varianza a partir de lo obtenido anteriormente.</li>
<li>Deducir una función de enlace para un modelo GLM con variable respuesta Poisson.</li>
</ol>
</section>
<section id="ejercicio-3-agresti-4.6" class="level3">
<h3 class="anchored" data-anchor-id="ejercicio-3-agresti-4.6">EJERCICIO 3 (AGRESTI 4.6)</h3>
<p>Suponiendo <span class="math inline">\(y_1 \sim \mathcal{P}\left(\lambda_i\right)\)</span> con <span class="math inline">\(g\left(\mu_i\right)=\beta_0+\beta_1 x_i\)</span> para <span class="math inline">\(x_i=1\)</span> para <span class="math inline">\(i=1, \ldots, n_A\)</span> y <span class="math inline">\(x_1=0\)</span> para <span class="math inline">\(i=n_A+1, \ldots, n_B\)</span>; observaciones independientes en ambos casos.</p>
<p>Probar que para la función de enlace logarítmico, las ecuaciones de verosimilitud implican que las medias ajustadas en cada grupo coinciden con las ñmedias muestrales.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2023, Luis Miguel Jáimez Rodríguez</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>